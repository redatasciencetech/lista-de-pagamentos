<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CÃ³digos de Pagamento MARG</title>
<style>
  :root{
    --bg:#f8f9fa; --card:#fff; --muted:#6c757d; --primary:#0d6efd; --danger:#dc3545; --success:#198754;
  }
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    margin:0; padding:20px; background:var(--bg); color:#222;
  }
  img.header{width:100%; height:auto; border-radius:6px; margin-bottom:16px; object-fit:cover}

  h4{ color:#c52323; margin:1rem 0; }

  /* Form */
  #form-adicionar{
    display:flex; gap:8px; flex-wrap:wrap;
    background:var(--card); border:1px solid #ddd; padding:12px; border-radius:8px;
  }
  #form-adicionar input{
    flex:1; padding:8px 10px; border-radius:6px; border:1px solid #ccc;
    min-width:150px;
  }
  #form-adicionar button{
    padding:8px 12px; border-radius:6px; border:0; cursor:pointer;
    background:var(--success); color:#fff;
  }
  #form-adicionar button:hover{ filter:brightness(.95) }

  /* Lista */
  #lista-pagamentos{ margin-top:14px; }
  .item{
    display:flex; align-items:center; justify-content:space-between;
    gap:12px; padding:10px 12px; background:var(--card); border:1px solid #ddd;
    border-radius:8px; margin-bottom:10px;
  }
  .info{
    display:flex; gap:12px; align-items:center;
    flex:1; min-width:0; /* ðŸ‘ˆ importante para ellipsis funcionar */
  }
  .descricao{
    font-weight:600; color:#222;
    flex:1; min-width:0; /* ðŸ‘ˆ impede de empurrar os botÃµes */
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }
  .codigo{
    font-family:monospace; font-size:0.95rem; color:#444;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:40%;
  }

  .acoes{ display:flex; gap:8px; flex-shrink:0; }
  .btn{
    border:0; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:14px;
  }
  .copy-btn{ background:var(--primary); color:#fff; }
  .copy-btn:hover{ filter:brightness(.95) }
  .remove-btn{ background:var(--danger); color:#fff; }
  .remove-btn:hover{ filter:brightness(.95) }

  .small{ font-size:0.85rem; color:var(--muted); margin-top:8px; }

  footer{
    margin-top:20px; border-top:1px solid #ddd; padding-top:12px; display:flex; gap:10px; align-items:center; justify-content:center;
    color:var(--muted); font-size:0.95rem;
  }
  @media (max-width:600px){
    .codigo{ max-width:35% }
    #form-adicionar{ flex-direction:column; }
    #form-adicionar button{ width:100% }
    .info{ flex-direction:column; align-items:flex-start; gap:6px }
    .acoes{ width:100%; justify-content:flex-end }
  }
</style>
</head>
<body>

<img src="cabecalho.png" alt="CabeÃ§alho" class="header">

<h4>Adicionar Novo Pagamento</h4>
<form id="form-adicionar" autocomplete="off">
  <input id="descricao" type="text" placeholder="DescriÃ§Ã£o (ex: BOLETO ou PIX - ITEM_VALOR_VENCIMENTO)" required />
  <input id="codigo" type="text" placeholder="CÃ³digo de BARRAS ou chave PIX (cole aqui)" required />
  <button type="submit">Adicionar</button>
</form>
<div class="small">Ao adicionar ou remover serÃ¡ solicitada a senha. O botÃ£o "Copiar" copia apenas o cÃ³digo (BARRAS/PIX).</div>

<h4>CÃ³digos de Pagamento</h4>
<div id="lista-pagamentos" aria-live="polite"></div>

<script>
/* ==================== CONFIGURAÃ‡ÃƒO ==================== */
const SENHA = "7025";
const LS_KEY = "meus_pagamentos_v1";

/* Elementos */
const listaEl = document.getElementById('lista-pagamentos');
const form = document.getElementById('form-adicionar');
const descInput = document.getElementById('descricao');
const codigoInput = document.getElementById('codigo');

/* ==================== UTIL ==================== */
function salvar(dados){
  try{ localStorage.setItem(LS_KEY, JSON.stringify(dados)); }
  catch(e){ console.error("Erro ao salvar localStorage", e); }
}
function carregar(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return null;
    return JSON.parse(raw);
  }catch(e){
    console.error("Erro ao ler localStorage", e);
    return null;
  }
}

/* ==================== INICIALIZAÃ‡ÃƒO ==================== */
let pagamentos = carregar();
if(!pagamentos){
  pagamentos = [
    { id: Date.now()+1, descricao: "CASA BAHIA (GELADEIRA) â€“ R$ 349,19", codigo: "34191 349189 000000 000000 000000 0" },
    { id: Date.now()+2, descricao: "SISTEMA SENSEBOARD â€“ R$ 597,00", codigo: "00020101021226870014BR.GOV.BCB.PIX0121..." }
  ];
  salvar(pagamentos);
}

/* ==================== RENDER ==================== */
function criarItemElement(item){
  const wrap = document.createElement('div');
  wrap.className = 'item';
  wrap.dataset.id = item.id;

  const info = document.createElement('div');
  info.className = 'info';

  const descricao = document.createElement('div');
  descricao.className = 'descricao';
  descricao.textContent = item.descricao;

  const codigo = document.createElement('div');
  codigo.className = 'codigo';
  codigo.textContent = item.codigo;
  codigo.title = item.codigo;

  info.appendChild(descricao);
  info.appendChild(codigo);

  const acoes = document.createElement('div');
  acoes.className = 'acoes';

  const copyBtn = document.createElement('button');
  copyBtn.type = 'button';
  copyBtn.className = 'btn copy-btn';
  copyBtn.textContent = 'Copiar';
  copyBtn.setAttribute('aria-label', 'Copiar cÃ³digo');
  copyBtn.addEventListener('click', async () => {
    await copyToClipboard(item.codigo, copyBtn);
  });

  const removeBtn = document.createElement('button');
  removeBtn.type = 'button';
  removeBtn.className = 'btn remove-btn';
  removeBtn.textContent = 'Remover';
  removeBtn.setAttribute('aria-label', 'Remover item');

  removeBtn.addEventListener('click', () => {
    const tentativa = prompt("Digite a senha para remover:");
    if(tentativa === null) return;
    if(tentativa !== SENHA){
      alert("Senha incorreta!");
      return;
    }
    pagamentos = pagamentos.filter(p => String(p.id) !== String(item.id));
    salvar(pagamentos);
    renderLista();
  });

  acoes.appendChild(copyBtn);
  acoes.appendChild(removeBtn);

  wrap.appendChild(info);
  wrap.appendChild(acoes);

  return wrap;
}

function renderLista(){
  listaEl.innerHTML = '';
  if(!pagamentos || pagamentos.length === 0){
    const vazio = document.createElement('div');
    vazio.textContent = "Nenhum pagamento adicionado.";
    vazio.style.color = "var(--muted)";
    listaEl.appendChild(vazio);
    return;
  }
  pagamentos.forEach(item => {
    listaEl.appendChild(criarItemElement(item));
  });
}

/* ==================== COPIAR ==================== */
async function copyToClipboard(text, btn){
  try{
    if(navigator.clipboard && navigator.clipboard.writeText){
      await navigator.clipboard.writeText(text);
    } else {
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position = 'fixed';
      ta.style.left = '-9999px';
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      document.body.removeChild(ta);
    }
    const original = btn.textContent;
    btn.textContent = 'Copiado!';
    btn.disabled = true;
    setTimeout(() => { btn.textContent = original; btn.disabled = false; }, 1300);
  }catch(err){
    console.error("Erro ao copiar:", err);
    alert("NÃ£o foi possÃ­vel copiar. Selecionar manualmente.");
  }
}

/* ==================== FORM ==================== */
form.addEventListener('submit', (ev) => {
  ev.preventDefault();
  const tentativa = prompt("Digite a senha para adicionar:");
  if(tentativa === null) return;
  if(tentativa !== SENHA){
    alert("Senha incorreta!");
    return;
  }

  const descricao = descInput.value.trim();
  const codigo = codigoInput.value.trim();
  if(!descricao || !codigo){
    alert("Preencha descriÃ§Ã£o e cÃ³digo.");
    return;
  }

  const novo = { id: Date.now() + Math.floor(Math.random()*999), descricao, codigo };
  pagamentos.unshift(novo);
  salvar(pagamentos);
  renderLista();
  form.reset();
  descInput.focus();
});

/* ==================== inicial render ==================== */
renderLista();
</script>

<footer>
  <img src="minha-logo.png" alt="Logo" style="height:28px;">
  <span>Â© 2025 RogÃ©rio Estumano</span>
</footer>
</body>
</html>


